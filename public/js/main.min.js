'use strict';

class Card {
	constructor() {
		this._cards = Array.from(document.querySelectorAll('.card'));
		this._is_liked = 'card__button_is-liked';
		this._is_disliked = 'card__button_is-disliked';
		this._svg_liked = 'svg__card_is-liked';
		this._svg_disliked = 'svg__card_is-disliked';

		this._addEventListener();
	}

	_addEventListener() {
		this._cards.forEach(card => {
			card.addEventListener('click', _ => {
				const dislike_button = card.querySelector('.card__button_dislike');
				const like_button = card.querySelector('.card__button_like');
				const dislike_svg = card.querySelectorAll('svg')[0];
				const like_svg = card.querySelectorAll('svg')[1];

				const current_card = {
					dislike_button: dislike_button,
					like_button: like_button,
					dislike_svg: dislike_svg,
					like_svg: like_svg
				};

				this._handleCard(current_card);
			})
		});
	}

	_handleCard(current_card) {
		current_card.dislike_button.addEventListener('click', _ => {
			this._toggleCardButton(current_card);
		});

		current_card.like_button.addEventListener('click', _ => {
			this._toggleCardButton(current_card);
		});
	}

	_toggleCardButton(button, svg) {}
}

new Card();
'use strict';

class Filter {
	constructor() {
		this._buttons = Array.from(document.querySelectorAll('.filter__button'));
		this._active = 'filter__button_active';

		this._addEventListener();
	}

	_addEventListener() {
		this._buttons.forEach(button => {
			button.addEventListener('click', _ => this._activateButton(button));
		});
	}

	_activateButton(current_button) {
		if (current_button.classList.contains(this._active)) return;

		//disactivate the other buttons.
		current_button.classList.add(this._active);
		this._buttons.forEach(button => {
			if (button !== current_button) button.classList.remove(this._active);
		});

		//get the url and get the page out of it.
		//then replace the current page content with the new content.
		const url = current_button.href;
		//new FetchPage(url, container);
	}
}

new Filter();
'use strict';
'use strict';

class Menu {
    constructor() {
        this.showButtonEl = document.querySelector('.js-menu-show');
        this.hideButtonEl = document.querySelector('.js-menu-hide');
        this.sideNavEl = document.querySelector('.js-side-nav');
        this.sideNavContainerEl = document.querySelector('.js-side-nav-container');

        this.showSideNav = this.showSideNav.bind(this);
        this.hideSideNav = this.hideSideNav.bind(this);
        this.blockClicks = this.blockClicks.bind(this);
        this.onTouchStart = this.onTouchStart.bind(this);
        this.onTouchMove = this.onTouchMove.bind(this);
        this.onTouchEnd = this.onTouchEnd.bind(this);
        this.onTransitionEnd = this.onTransitionEnd.bind(this);
        this.update = this.update.bind(this);

        this.startX = 0;
        this.currentX = 0;
        this.touchingSideNav = false;

        this.transitionEndProperty = null;
        this.transitionEndTime = 0;

        this.supportsPassive = undefined;
        this.addEventListeners();
    }

    applyPassive() {
        if (this.supportsPassive !== undefined) {
            return this.supportsPassive ? { passive: true } : false;
        }
        
        let isSupported = false;
        try {
            document.addEventListener('test', null, {
                get passive() {
                    isSupported = true;
                }
            });
        } catch (e) { }
        this.supportsPassive = isSupported;
        return this.applyPassive();
    }

    addEventListeners() {
        this.showButtonEl.addEventListener('click', this.showSideNav);
        this.hideButtonEl.addEventListener('click', this.hideSideNav);
        this.sideNavEl.addEventListener('click', this.hideSideNav);
        this.sideNavContainerEl.addEventListener('click', this.blockClicks);

        this.sideNavEl.addEventListener('touchstart', this.onTouchStart, this.applyPassive());
        this.sideNavEl.addEventListener('touchmove', this.onTouchMove, this.applyPassive());
        this.sideNavEl.addEventListener('touchend', this.onTouchEnd);
    }

    onTouchStart(evt) {
        if (!this.sideNavEl.classList.contains('side-nav--visible'))
            return;

        this.startX = evt.touches[0].pageX;
        this.currentX = this.startX;

        this.touchingSideNav = true;
        requestAnimationFrame(this.update);
    }

    onTouchMove(evt) {
        if (!this.touchingSideNav)
            return;

        this.currentX = evt.touches[0].pageX;
    }

    onTouchEnd(evt) {
        if (!this.touchingSideNav)
            return;

        this.touchingSideNav = false;

        const translateX = Math.min(0, this.currentX - this.startX);
        this.sideNavContainerEl.style.transform = '';

        if (translateX < 0) {
            this.hideSideNav();
        }
    }

    update() {
        if (!this.touchingSideNav)
            return;

        requestAnimationFrame(this.update);

        const translateX = Math.min(0, this.currentX - this.startX);
        this.sideNavContainerEl.style.transform = `translateX(${translateX}px)`;
    }

    blockClicks(evt) {
        evt.stopPropagation();
    }

    onTransitionEnd(evt) {
        if (evt.propertyName != this.transitionEndProperty && evt.elapsedTime != this.transitionEndTime) {
            return;
        }

        this.transitionEndProperty = null;
        this.transitionEndTime = 0;

        this.sideNavEl.classList.remove('side-nav--animatable');
        this.sideNavEl.removeEventListener('transitionend', this.onTransitionEnd);
    }

    showSideNav() {
        this.sideNavEl.classList.add('side-nav--animatable');
        this.sideNavEl.classList.add('side-nav--visible');

        this.transitionEndProperty = 'transform';
        this.transitionEndTime = 0.33;

        this.sideNavEl.addEventListener('transitionend', this.onTransitionEnd);
    }

    hideSideNav() {
        this.sideNavEl.classList.add('side-nav--animatable');
        this.sideNavEl.classList.remove('side-nav--visible');

        this.transitionEndProperty = 'transform';
        this.transitionEndTime = 0.13;

        this.sideNavEl.addEventListener('transitionend', this.onTransitionEnd);
    }
}

new Menu();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL2NhcmQuanMiLCJqcy9maWx0ZXIuanMiLCJqcy9tYWluLmpzIiwianMvbWVudS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDOUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2hDQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNsYXNzIENhcmQge1xuXHRjb25zdHJ1Y3RvcigpIHtcblx0XHR0aGlzLl9jYXJkcyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNhcmQnKSk7XG5cdFx0dGhpcy5faXNfbGlrZWQgPSAnY2FyZF9fYnV0dG9uX2lzLWxpa2VkJztcblx0XHR0aGlzLl9pc19kaXNsaWtlZCA9ICdjYXJkX19idXR0b25faXMtZGlzbGlrZWQnO1xuXHRcdHRoaXMuX3N2Z19saWtlZCA9ICdzdmdfX2NhcmRfaXMtbGlrZWQnO1xuXHRcdHRoaXMuX3N2Z19kaXNsaWtlZCA9ICdzdmdfX2NhcmRfaXMtZGlzbGlrZWQnO1xuXG5cdFx0dGhpcy5fYWRkRXZlbnRMaXN0ZW5lcigpO1xuXHR9XG5cblx0X2FkZEV2ZW50TGlzdGVuZXIoKSB7XG5cdFx0dGhpcy5fY2FyZHMuZm9yRWFjaChjYXJkID0+IHtcblx0XHRcdGNhcmQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBfID0+IHtcblx0XHRcdFx0Y29uc3QgZGlzbGlrZV9idXR0b24gPSBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19idXR0b25fZGlzbGlrZScpO1xuXHRcdFx0XHRjb25zdCBsaWtlX2J1dHRvbiA9IGNhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2J1dHRvbl9saWtlJyk7XG5cdFx0XHRcdGNvbnN0IGRpc2xpa2Vfc3ZnID0gY2FyZC5xdWVyeVNlbGVjdG9yQWxsKCdzdmcnKVswXTtcblx0XHRcdFx0Y29uc3QgbGlrZV9zdmcgPSBjYXJkLnF1ZXJ5U2VsZWN0b3JBbGwoJ3N2ZycpWzFdO1xuXG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRfY2FyZCA9IHtcblx0XHRcdFx0XHRkaXNsaWtlX2J1dHRvbjogZGlzbGlrZV9idXR0b24sXG5cdFx0XHRcdFx0bGlrZV9idXR0b246IGxpa2VfYnV0dG9uLFxuXHRcdFx0XHRcdGRpc2xpa2Vfc3ZnOiBkaXNsaWtlX3N2Zyxcblx0XHRcdFx0XHRsaWtlX3N2ZzogbGlrZV9zdmdcblx0XHRcdFx0fTtcblxuXHRcdFx0XHR0aGlzLl9oYW5kbGVDYXJkKGN1cnJlbnRfY2FyZCk7XG5cdFx0XHR9KVxuXHRcdH0pO1xuXHR9XG5cblx0X2hhbmRsZUNhcmQoY3VycmVudF9jYXJkKSB7XG5cdFx0Y3VycmVudF9jYXJkLmRpc2xpa2VfYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgXyA9PiB7XG5cdFx0XHR0aGlzLl90b2dnbGVDYXJkQnV0dG9uKGN1cnJlbnRfY2FyZCk7XG5cdFx0fSk7XG5cblx0XHRjdXJyZW50X2NhcmQubGlrZV9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBfID0+IHtcblx0XHRcdHRoaXMuX3RvZ2dsZUNhcmRCdXR0b24oY3VycmVudF9jYXJkKTtcblx0XHR9KTtcblx0fVxuXG5cdF90b2dnbGVDYXJkQnV0dG9uKGJ1dHRvbiwgc3ZnKSB7fVxufVxuXG5uZXcgQ2FyZCgpOyIsIid1c2Ugc3RyaWN0JztcblxuY2xhc3MgRmlsdGVyIHtcblx0Y29uc3RydWN0b3IoKSB7XG5cdFx0dGhpcy5fYnV0dG9ucyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZpbHRlcl9fYnV0dG9uJykpO1xuXHRcdHRoaXMuX2FjdGl2ZSA9ICdmaWx0ZXJfX2J1dHRvbl9hY3RpdmUnO1xuXG5cdFx0dGhpcy5fYWRkRXZlbnRMaXN0ZW5lcigpO1xuXHR9XG5cblx0X2FkZEV2ZW50TGlzdGVuZXIoKSB7XG5cdFx0dGhpcy5fYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiB7XG5cdFx0XHRidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBfID0+IHRoaXMuX2FjdGl2YXRlQnV0dG9uKGJ1dHRvbikpO1xuXHRcdH0pO1xuXHR9XG5cblx0X2FjdGl2YXRlQnV0dG9uKGN1cnJlbnRfYnV0dG9uKSB7XG5cdFx0aWYgKGN1cnJlbnRfYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucyh0aGlzLl9hY3RpdmUpKSByZXR1cm47XG5cblx0XHQvL2Rpc2FjdGl2YXRlIHRoZSBvdGhlciBidXR0b25zLlxuXHRcdGN1cnJlbnRfYnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5fYWN0aXZlKTtcblx0XHR0aGlzLl9idXR0b25zLmZvckVhY2goYnV0dG9uID0+IHtcblx0XHRcdGlmIChidXR0b24gIT09IGN1cnJlbnRfYnV0dG9uKSBidXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9hY3RpdmUpO1xuXHRcdH0pO1xuXG5cdFx0Ly9nZXQgdGhlIHVybCBhbmQgZ2V0IHRoZSBwYWdlIG91dCBvZiBpdC5cblx0XHQvL3RoZW4gcmVwbGFjZSB0aGUgY3VycmVudCBwYWdlIGNvbnRlbnQgd2l0aCB0aGUgbmV3IGNvbnRlbnQuXG5cdFx0Y29uc3QgdXJsID0gY3VycmVudF9idXR0b24uaHJlZjtcblx0XHQvL25ldyBGZXRjaFBhZ2UodXJsLCBjb250YWluZXIpO1xuXHR9XG59XG5cbm5ldyBGaWx0ZXIoKTsiLCIndXNlIHN0cmljdCc7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuY2xhc3MgTWVudSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnNob3dCdXR0b25FbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1tZW51LXNob3cnKTtcclxuICAgICAgICB0aGlzLmhpZGVCdXR0b25FbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1tZW51LWhpZGUnKTtcclxuICAgICAgICB0aGlzLnNpZGVOYXZFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1zaWRlLW5hdicpO1xyXG4gICAgICAgIHRoaXMuc2lkZU5hdkNvbnRhaW5lckVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLXNpZGUtbmF2LWNvbnRhaW5lcicpO1xyXG5cclxuICAgICAgICB0aGlzLnNob3dTaWRlTmF2ID0gdGhpcy5zaG93U2lkZU5hdi5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuaGlkZVNpZGVOYXYgPSB0aGlzLmhpZGVTaWRlTmF2LmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5ibG9ja0NsaWNrcyA9IHRoaXMuYmxvY2tDbGlja3MuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLm9uVG91Y2hTdGFydCA9IHRoaXMub25Ub3VjaFN0YXJ0LmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5vblRvdWNoTW92ZSA9IHRoaXMub25Ub3VjaE1vdmUuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLm9uVG91Y2hFbmQgPSB0aGlzLm9uVG91Y2hFbmQuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLm9uVHJhbnNpdGlvbkVuZCA9IHRoaXMub25UcmFuc2l0aW9uRW5kLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy51cGRhdGUgPSB0aGlzLnVwZGF0ZS5iaW5kKHRoaXMpO1xyXG5cclxuICAgICAgICB0aGlzLnN0YXJ0WCA9IDA7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50WCA9IDA7XHJcbiAgICAgICAgdGhpcy50b3VjaGluZ1NpZGVOYXYgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy50cmFuc2l0aW9uRW5kUHJvcGVydHkgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudHJhbnNpdGlvbkVuZFRpbWUgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLnN1cHBvcnRzUGFzc2l2ZSA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgYXBwbHlQYXNzaXZlKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnN1cHBvcnRzUGFzc2l2ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN1cHBvcnRzUGFzc2l2ZSA/IHsgcGFzc2l2ZTogdHJ1ZSB9IDogZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBpc1N1cHBvcnRlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Rlc3QnLCBudWxsLCB7XHJcbiAgICAgICAgICAgICAgICBnZXQgcGFzc2l2ZSgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpc1N1cHBvcnRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgfVxyXG4gICAgICAgIHRoaXMuc3VwcG9ydHNQYXNzaXZlID0gaXNTdXBwb3J0ZWQ7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlQYXNzaXZlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkRXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5zaG93QnV0dG9uRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnNob3dTaWRlTmF2KTtcclxuICAgICAgICB0aGlzLmhpZGVCdXR0b25FbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuaGlkZVNpZGVOYXYpO1xyXG4gICAgICAgIHRoaXMuc2lkZU5hdkVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oaWRlU2lkZU5hdik7XHJcbiAgICAgICAgdGhpcy5zaWRlTmF2Q29udGFpbmVyRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmJsb2NrQ2xpY2tzKTtcclxuXHJcbiAgICAgICAgdGhpcy5zaWRlTmF2RWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMub25Ub3VjaFN0YXJ0LCB0aGlzLmFwcGx5UGFzc2l2ZSgpKTtcclxuICAgICAgICB0aGlzLnNpZGVOYXZFbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLm9uVG91Y2hNb3ZlLCB0aGlzLmFwcGx5UGFzc2l2ZSgpKTtcclxuICAgICAgICB0aGlzLnNpZGVOYXZFbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHRoaXMub25Ub3VjaEVuZCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25Ub3VjaFN0YXJ0KGV2dCkge1xyXG4gICAgICAgIGlmICghdGhpcy5zaWRlTmF2RWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaWRlLW5hdi0tdmlzaWJsZScpKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgIHRoaXMuc3RhcnRYID0gZXZ0LnRvdWNoZXNbMF0ucGFnZVg7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50WCA9IHRoaXMuc3RhcnRYO1xyXG5cclxuICAgICAgICB0aGlzLnRvdWNoaW5nU2lkZU5hdiA9IHRydWU7XHJcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMudXBkYXRlKTtcclxuICAgIH1cclxuXHJcbiAgICBvblRvdWNoTW92ZShldnQpIHtcclxuICAgICAgICBpZiAoIXRoaXMudG91Y2hpbmdTaWRlTmF2KVxyXG4gICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgIHRoaXMuY3VycmVudFggPSBldnQudG91Y2hlc1swXS5wYWdlWDtcclxuICAgIH1cclxuXHJcbiAgICBvblRvdWNoRW5kKGV2dCkge1xyXG4gICAgICAgIGlmICghdGhpcy50b3VjaGluZ1NpZGVOYXYpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuXHJcbiAgICAgICAgdGhpcy50b3VjaGluZ1NpZGVOYXYgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgY29uc3QgdHJhbnNsYXRlWCA9IE1hdGgubWluKDAsIHRoaXMuY3VycmVudFggLSB0aGlzLnN0YXJ0WCk7XHJcbiAgICAgICAgdGhpcy5zaWRlTmF2Q29udGFpbmVyRWwuc3R5bGUudHJhbnNmb3JtID0gJyc7XHJcblxyXG4gICAgICAgIGlmICh0cmFuc2xhdGVYIDwgMCkge1xyXG4gICAgICAgICAgICB0aGlzLmhpZGVTaWRlTmF2KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZSgpIHtcclxuICAgICAgICBpZiAoIXRoaXMudG91Y2hpbmdTaWRlTmF2KVxyXG4gICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnVwZGF0ZSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHRyYW5zbGF0ZVggPSBNYXRoLm1pbigwLCB0aGlzLmN1cnJlbnRYIC0gdGhpcy5zdGFydFgpO1xyXG4gICAgICAgIHRoaXMuc2lkZU5hdkNvbnRhaW5lckVsLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKCR7dHJhbnNsYXRlWH1weClgO1xyXG4gICAgfVxyXG5cclxuICAgIGJsb2NrQ2xpY2tzKGV2dCkge1xyXG4gICAgICAgIGV2dC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH1cclxuXHJcbiAgICBvblRyYW5zaXRpb25FbmQoZXZ0KSB7XHJcbiAgICAgICAgaWYgKGV2dC5wcm9wZXJ0eU5hbWUgIT0gdGhpcy50cmFuc2l0aW9uRW5kUHJvcGVydHkgJiYgZXZ0LmVsYXBzZWRUaW1lICE9IHRoaXMudHJhbnNpdGlvbkVuZFRpbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy50cmFuc2l0aW9uRW5kUHJvcGVydHkgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudHJhbnNpdGlvbkVuZFRpbWUgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLnNpZGVOYXZFbC5jbGFzc0xpc3QucmVtb3ZlKCdzaWRlLW5hdi0tYW5pbWF0YWJsZScpO1xyXG4gICAgICAgIHRoaXMuc2lkZU5hdkVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RyYW5zaXRpb25lbmQnLCB0aGlzLm9uVHJhbnNpdGlvbkVuZCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2hvd1NpZGVOYXYoKSB7XHJcbiAgICAgICAgdGhpcy5zaWRlTmF2RWwuY2xhc3NMaXN0LmFkZCgnc2lkZS1uYXYtLWFuaW1hdGFibGUnKTtcclxuICAgICAgICB0aGlzLnNpZGVOYXZFbC5jbGFzc0xpc3QuYWRkKCdzaWRlLW5hdi0tdmlzaWJsZScpO1xyXG5cclxuICAgICAgICB0aGlzLnRyYW5zaXRpb25FbmRQcm9wZXJ0eSA9ICd0cmFuc2Zvcm0nO1xyXG4gICAgICAgIHRoaXMudHJhbnNpdGlvbkVuZFRpbWUgPSAwLjMzO1xyXG5cclxuICAgICAgICB0aGlzLnNpZGVOYXZFbC5hZGRFdmVudExpc3RlbmVyKCd0cmFuc2l0aW9uZW5kJywgdGhpcy5vblRyYW5zaXRpb25FbmQpO1xyXG4gICAgfVxyXG5cclxuICAgIGhpZGVTaWRlTmF2KCkge1xyXG4gICAgICAgIHRoaXMuc2lkZU5hdkVsLmNsYXNzTGlzdC5hZGQoJ3NpZGUtbmF2LS1hbmltYXRhYmxlJyk7XHJcbiAgICAgICAgdGhpcy5zaWRlTmF2RWwuY2xhc3NMaXN0LnJlbW92ZSgnc2lkZS1uYXYtLXZpc2libGUnKTtcclxuXHJcbiAgICAgICAgdGhpcy50cmFuc2l0aW9uRW5kUHJvcGVydHkgPSAndHJhbnNmb3JtJztcclxuICAgICAgICB0aGlzLnRyYW5zaXRpb25FbmRUaW1lID0gMC4xMztcclxuXHJcbiAgICAgICAgdGhpcy5zaWRlTmF2RWwuYWRkRXZlbnRMaXN0ZW5lcigndHJhbnNpdGlvbmVuZCcsIHRoaXMub25UcmFuc2l0aW9uRW5kKTtcclxuICAgIH1cclxufVxyXG5cclxubmV3IE1lbnUoKTsiXX0=
